/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/**
 * FX v3.0
 * Copyright (c) 2011 Ryan Morr (ryanmorr.com)
 * Licensed under the MIT license.
 */

/**
 * FX Node (plugin)
 * Copyright (c) 2011 Ryan Morr (ryanmorr.com)
 * Licensed under the MIT license.
 */

define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),define("dom",[],function(){var e="@VERSION",t=e.trim,n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r=function(e){return new r.prototype.init(e)};return r.prototype={constructor:r,init:function(e){return this.node=document.getElementById(e),this},hasClass:function(e){return this.node.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(e){return this.hasClass(e)||(this.node.className+=" "+e),this},removeClass:function(e){if(this.hasClass(e)){var t=new RegExp("(\\s|^)"+e+"(\\s|$)");this.node.className=r.trim(this.node.className.replace(t," "))}return this},getEle:function(){return this.node},hide:function(){return this.node.style.display="none",this},show:function(){return this.node.style.display="",this},setHtml:function(e){return this.node.innerHTML=e,this},getHtml:function(){return this.node.innerHTML},setStyle:function(e,t){return e==="opacity"?(this.node.style.filter="alpha(opacity="+t*100+")",this.node.style.opacity=t):(e=r.toCamelCase(e),this.node.style[e]=t),this},getPos:function(){var e={t:0,l:0},t=this.node;while(t)e.t+=t.offsetTop,e.l+=t.offsetLeft,t=t.offsetParent;return e},isInView:function(){var e=document.body.scrollTop+document.documentElement.scrollTop,t=e+document.documentElement.clientHeight,n=document.documentElement.scrollLeft,r=n+document.documentElement.clientWidth,i=this.node,s={};return i?(s=this.getPos(),(s.t>=e||s.t+i.clientHeight>=e)&&s.t<=t&&(s.l>=n||s.l+i.clientWidth>=n)&&s.l<=r?!0:!1):!1}},r.toCamelCase=function(e){var t=e.split("-"),n=t[0],r=t.length,i;if(r>1)for(i=1;i<r;i++)n+=t[i].charAt(0).toUpperCase()+t[i].substring(1);return n},r.trim=function(e){return t&&!t.call("﻿ ")?e===null?"":t.call(e):e===null?"":(e+"").replace(n,"")},r.prototype.init.prototype=r.prototype,r}),define("eventutil",[],function(){var e={};return e.addEventHandler=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},e.removeEventHandler=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},e.isMouseLeaveOrEnter=function(e,t){if(e.type!="mouseout"&&e.type!="mouseover")return!1;var n=e.relatedTarget?e.relatedTarget:e.type=="mouseout"?e.toElement:e.fromElement;while(n&&n!=t)n=n.parentNode;return n!=t},e.moveLeaveHandler=function(e,t){e=e||window.event;var n=!0;return e.toElement?n=!this.contains(t,e.toElement):e.relatedTarget&&(n=!this.contains(t,e.relatedTarget)),n},e.contains=function(e,t){if(e.contains)return e.contains(t);var n=t;while(n&&n.parentNode.tagName!="undefined"){if(n==e)return!0;n=n.parentNode}return!1},e}),define("lazy",["eventutil","dom"],function(e,t){var n={};return n=function(){function i(e){var t={Top:0,Left:0};while(!!e)t.Top+=e.offsetTop,t.Left+=e.offsetLeft,e=e.offsetParent;return t}function s(){var e,t={},n={},s,o,u,a,f;t.Top=document.body.scrollTop||document.documentElement.scrollTop,t.Left=document.documentElement.scrollLeft,n.Top=t.Top+1*document.documentElement.clientHeight,n.Left=t.Left+document.documentElement.clientWidth;for(e in r)if(r[e]){s=r[e],o=document.getElementById(e);if(!o){o=null;continue}u=o.clientWidth,a=o.clientHeight,f=i(o),(f.Top>t.Top&&f.Top<n.Top&&f.Left>t.Left&&f.Left<n.Left||f.Top+a>t.Top&&f.Top<n.Top&&f.Left+u>t.Left&&f.Left<n.Left)&&(function(e,t){setTimeout(function(){e.src=t,e.removeAttribute("_src")},10)}(o,s.src),delete r[e])}}function o(){t&&clearTimeout(t),t=setTimeout(function(){s()},50)}var t=null,r={};return{init:function(){var e=0,t=document.body.getElementsByTagName("iframe"),r,i;for(e=0;e<document.images.length;e++){r=document.images[e],i={},i.id=r.id,i.src=r.getAttribute("_src"),i.src&&!i.id&&(i.id=encodeURIComponent(i.src)+Math.random(),r.id=i.id);if(!i.id||!i.src)continue;n.push(i)}},push:function(e){r[e.id]=e},run:function(){e.addEventHandler(window,"scroll",o),s()},resize_run:s}}(),n}),define("switchtab",["dom","eventutil","lazy"],function(e,t,n){function r(){this.config={},this.tabs=[],this.lists=[],this.timer=0,this.idx=0,this.lag_timer=0,this.lag_flag=!1}return r.prototype={init:function(n){for(conf in n)this.config[conf]=n[conf];var r=this;for(var i=0;i<this.config.count;i++)this.tabs[i]=e(this.config.identifyTab+i),this.lists[i]=e(this.config.identifyList+i),function(e){r.config.auto===!0?(t.addEventHandler(r.tabs[e].getEle(),"mouseover",function(n){t.isMouseLeaveOrEnter(n,r.tabs[e].getEle())&&(r.pause(),r.show(e))}),t.addEventHandler(r.lists[e].getEle(),"mouseover",function(n){t.isMouseLeaveOrEnter(n,r.lists[e].getEle())&&r.pause()}),t.addEventHandler(r.tabs[e].getEle(),"mouseout",function(n){t.isMouseLeaveOrEnter(n,r.tabs[e].getEle())&&(r.pause(),r.auto())}),t.addEventHandler(r.lists[e].getEle(),"mouseout",function(n){t.isMouseLeaveOrEnter(n,r.lists[e].getEle())&&(r.pause(),r.auto())})):(t.addEventHandler(r.tabs[e].getEle(),"mouseover",function(n){r.lag_flag=!0,typeof r.config.lag!="undefined"?r.lag_timer=setTimeout(function(){r.lag_flag&&r.show(e)},parseInt(r.config.lag)):t.isMouseLeaveOrEnter(n,r.tabs[e].getEle())||r.show(e)}),t.addEventHandler(r.tabs[e].getEle(),"mouseout",function(e){r.lag_flag=!1,clearTimeout(r.lag_timer)}))}(i);this.config.auto===!0&&this.auto()},auto:function(){var e=this;this.timer=setInterval(function(){e.next()},this.config.interval)},next:function(){this.idx=this.idx+1,this.idx>=this.config.count&&(this.idx=0),this.show(this.idx)},pause:function(){clearInterval(this.timer)},show:function(e){for(var t=0;t<this.config.count;t++)t!=e&&(this.tabs[t].removeClass(this.config.cnon),this.lists[t].hide());this.tabs[e].addClass(this.config.cnon),this.lists[e].show();if(this.config.callback)for(key in this.config.callback)(e==key||"all"==key)&&this.config.callback[key].call(this,e);n.resize_run(),this.idx=e}},r}),define("fx",[],function(){function c(e){return typeof e=="string"?t.getElementById(e):e}function h(e,t,n){t=="opacity"?(e.style.filter="alpha(opacity="+n*100+")",e.style.opacity=n):(t=d(t),e.style[t]=n)}function p(e,t,r,i){var s=parseFloat(o(e,t))||0;return i!="px"&&n&&(h(e,t,(r||1)+i),s=(r||1)/parseFloat(o(e,t))*s,h(e,t,s+i)),s}function d(e){if(e in i)return i[e];var t=e.split("-"),n=t[0],r=t.length;if(r>1)for(var s=1;s<r;s++)n+=t[s].charAt(0).toUpperCase()+t[s].substring(1);return i[e]=n}function v(e){if(e in i)return i[e];var t=e.match(u);if(t&&t.length==4)return i[e]=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)];t=e.match(f);if(t&&t.length==4)return i[e]=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)];t=e.match(a);if(t&&t.length==4)return i[e]=[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}var e=window,t=e.document,n=t.defaultView,r=Object.prototype.toString,i={},s=function(){},o,u=/^#(\w{2})(\w{2})(\w{2})$/,a=/^#(\w{1})(\w{1})(\w{1})$/,f=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,l=function(t,n,r,i,o,u){this.el=c(t),this.attributes=n,this.duration=r||.7,this.transition=l.transitions[i||"easeInOut"],this.callback=o||s,this.ctx=u||e,this.animating=!1,this.units={},this.frame={},this.endAttr={},this.startAttr={}};l.transitions={linear:function(e,t,n,r){return n*e/r+t},easeIn:function(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t},easeOut:function(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t},easeInOut:function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t}},l.prototype={start:function(){var e=this;e.getAttributes(),e.duration=e.duration*1e3,e.time=g(),e.animating=!0,e.timer=setInterval(function(){var t=g();t<e.time+e.duration?(e.elapsed=t-e.time,e.setCurrentFrame()):(e.frame=e.endAttr,e.complete()),e.setAttributes()},10)},stop:function(e){e&&(this.frame=this.endAttr,this.setAttributes()),this.complete()},isAnimating:function(){return this.animating},ease:function(e,t){return this.transition(this.elapsed,e,t-e,this.duration)},complete:function(){clearInterval(this.timer),this.timer=null,this.animating=!1,this.callback.call(this.ctx)},setCurrentFrame:function(){var e,t;for(var n in this.startAttr){e=this.startAttr[n],t=this.endAttr[n];if(m(e)){this.frame[n]=[];for(var r=0,i=e.length;r<i;r++)this.frame[n][r]=this.ease(e[r],t[r])}else this.frame[n]=this.ease(e,t)}},getAttributes:function(){var e,n,r=this.el;for(e in this.attributes){n=this.attributes[e];switch(e){case"color":case"borderColor":case"border-color":case"backgroundColor":case"background-color":this.startAttr[e]=v(n.from||o(r,e)),this.endAttr[e]=v(n.to);break;case"scrollTop":case"scrollLeft":r=this.el=r==t.body?t.documentElement||t.body:r,this.startAttr[e]=n.from||r[e],this.endAttr[e]=n.to;break;default:var i=n.to,s=n.units||"px",u="from"in n?n.from:p(r,e,i,s);this.units[e]=s,this.endAttr[e]=i,this.startAttr[e]=u}}},setAttributes:function(){var e,t,n,r=this.el;for(e in this.frame){t=this.frame[e],n=this.units[e];switch(e){case"opacity":h(r,e,t);break;case"scrollLeft":case"scrollTop":r[e]=t;break;case"color":case"borderColor":case"border-color":case"backgroundColor":case"background-color":h(r,e,"rgb("+Math.floor(t[0])+","+Math.floor(t[1])+","+Math.floor(t[2])+")");break;default:h(r,e,t+n)}}}},!!n&&"getComputedStyle"in n?o=function(e,t){return t=d(t),n.getComputedStyle(e,"")[t]||null}:o=function(e,t){if(t=="opacity"){value=100;try{value=e.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(n){try{value=e.filters("alpha").opacity}catch(n){}}return value=isNaN(value)?100:value||0,value/100}return t=d(t),e.currentStyle[t]||null},l.getStyle=o;var m=Array.isArray||function(e){return r.call(e)==="[object Array]"},g=Date.now||function(){return(new Date).getTime()};return l}),define("node",["fx"],function(e){function i(){this.items=[]}var t=window,n=t.document,r=function(){};return e.Node=function(e){this.queue=new i,this.el=typeof e=="string"?n.getElementById(e):e},e.Node.prototype={isAnimating:function(){return this.activeFx&&this.activeFx.isAnimating()||!this.queue.isEmpty()},stop:function(e){this.queue.clear(),this.activeFx&&this.activeFx.stop(e)},pause:function(e){var t=this,e=e||1;return this.queueFx({},function(){var n=setTimeout(function(){t.nextFx(),clearTimeout(n),n=null},e*1e3);return null})},animate:function(n){return this.queueFx(n,function(){return new e(this.el,n.attributes,n.duration||1,n.transition||"easeInOut",n.callback||r,n.scope||t)})},highlight:function(n,i){return i=i||{},this.queueFx(i,function(){return new e(this.el,{"background-color":{from:n||"#ffff9c",to:e.getStyle(this.el,"backgroundColor")||"#ffffff"}},i.duration||1,i.transition||"easeIn",i.callback||r,i.scope||t)})},fadeIn:function(n){return n=n||{},this.queueFx(n,function(){return new e(this.el,{opacity:{to:1}},n.duration||.5,n.transition||"easeOut",n.callback||r,n.scope||t)})},fadeOut:function(n){return n=n||{},this.queueFx(n,function(){return new e(this.el,{opacity:{to:0}},n.duration||.5,n.transition||"easeOut",n.callback||r,n.scope||t)})},move:function(n,i,s){return s=s||{},this.queueFx(s,function(){return new e(this.el,{left:{to:n},top:{to:i}},s.duration||.5,s.transition||"easeInOut",s.callback||r,s.scope||t)})},scale:function(n,i,s){return s=s||{},this.queueFx(s,function(){return new e(this.el,{width:{to:n},height:{to:i}},s.duration||.5,s.transition||"easeInOut",s.callback||r,s.scope||t)})},queueFx:function(e,t){return e.queue&&e.queue==0||!this.activeFx?(this.callFx(t,e.queue),this):(this.queue.enqueue(t),this)},callFx:function(e,t){var n=e.call(this);if(n){this.activeFx=n;var r=this,t=t||!0;if(t==1){var i=n.callback,s=n.ctx;n.callback=function(){i.call(s),r.nextFx()}}n.start()}},nextFx:function(){this.activeFx&&delete this.activeFx;var e=this.queue.dequeue();e&&this.callFx(e)}},i.prototype={enqueue:function(e){this.items.push(e)},dequeue:function(){var e=this.items.shift();return e?e:null},isEmpty:function(){return this.items.length==0},clear:function(){this.items=[]}},e}),define("turn",["dom","eventutil","node"],function(e,t,n,r){function i(){this.config={},this.node={},this.interval=0}return i.prototype={init:function(i){for(conf in i)this.config[conf]=i[conf];this.node=new n.Node(i.div),this.config.auto===!0&&(this.config.valign===!0?e(this.config.div).setHtml(e(this.config.div).getHtml()+e(this.config.div).getHtml()):e(this.config.divSibling).setHtml(e(this.config.div).getHtml()),this.auto());var s=this;this.config.prev!==r&&(t.addEventHandler(e(i.prev).getEle(),"click",function(){s.pre()}),this.config.auto===!0&&(t.addEventHandler(e(i.prev).getEle(),"mouseover",function(){s.stop()}),t.addEventHandler(e(i.prev).getEle(),"mouseout",function(){s.auto()}))),this.config.next!==r&&(t.addEventHandler(e(i.next).getEle(),"click",function(){s.next()}),this.config.auto===!0&&(t.addEventHandler(e(i.next).getEle(),"mouseover",function(){s.stop()}),t.addEventHandler(e(i.next).getEle(),"mouseout",function(){s.auto()})));if(this.config.nav!==r)for(var o=0;o<this.config.allpage;o++)(function(n){t.addEventHandler(e(s.config.nav+n).getEle(),"click",function(){s.go(n)})})(o)},pre:function(){if(this.config.clickflag>0)return;if(!this.config.auto&&this.config.current==0)return;this.go(this.config.current-1)},next:function(){if(this.config.clickflag>0)return;if(!this.config.auto&&this.config.current==this.config.allpage-1)return;this.go(this.config.current+1)},auto:function(){var e=this;this.interval=setInterval(function(){e.next()},this.config.time)},stop:function(){clearInterval(this.interval)},go:function(t){if(this.config.current===t)return;this.config.clickflag=1;var n=0;t>=this.config.allpage?n=-(this.config.allpage*this.config.step):t<0?(this.config.valign===!0?e(this.config.div).setStyle("top",-(this.config.allpage*this.config.step)+"px"):e(this.config.div).setStyle("margin-left",-(this.config.allpage*this.config.step)+"px"),n=-((this.config.allpage-1)*this.config.step)):n=-(t*this.config.step);var i=this,s;this.config.valign===!0?s={top:{to:n}}:s={marginLeft:{to:n}},this.node.animate({duration:this.config.speed,attributes:s,callback:function(){i.config.clickflag=0,t>=i.config.allpage?(i.config.current=0,setTimeout(function(){i.config.valign===!0?e(i.config.div).setStyle("top","0px"):e(i.config.div).setStyle("margin-left","0px")})):t<0?i.config.current=i.config.allpage-1:i.config.current=t;if(i.config.nav!==r)for(var n=0;n<i.config.allpage;n++)i.config.current===n?e(i.config.nav+n).addClass("on"):e(i.config.nav+n).removeClass("on")}}),this.config.auto||(t>=this.config.allpage-1?(e(this.config.next).addClass(this.config.offClsRight),e(this.config.prev).removeClass(this.config.offClsLeft)):t<=0?(e(this.config.next).removeClass(this.config.offClsRight),e(this.config.prev).addClass(this.config.offClsLeft)):(e(this.config.next).removeClass(this.config.offClsRight),e(this.config.prev).removeClass(this.config.offClsLeft)))}},i}),define("fav",["jquery","turn","lazy"],function(e,t,n){var r=new t,i={count:0,url:"http://history.yun.kankan.com:8082/",serialize:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},getBaseParams:function(){var e=kkTool.Cookie.get("sessionid"),t=kkTool.Cookie.get("userid"),n="",r="Web",s="pc",o="",u="web",a="",f="json",l=2;return i.serialize({sessionid:e,userid:t,businessid:n,logintype:r,devicetype:s,deviceversion:o,product:u,productversion:a,format:f,protocolver:l})},prepareFav:function(){var e=this;kkTool.Cookie.get("userid")?kkTool.getScript(e.url+"query?"+e.getBaseParams()+"&obj=KK_FAV_OBJ_GRZX&type=long&size=28&rd="+Math.random(),function(){KK_FAV_OBJ_GRZX.code==0&&(e.showFavBody(),e.printFav())},[],!0,"utf-8"):e.showFavBody()},getFavRecord:function(e){var t="||",n="@@";try{var r=ioCtrl.ioReader("fav_click_history").split(t);for(var i=0,s=r.length;i<s;i++){var o=r[i].split(n);if(o[0]==e)return o[1]}return""}catch(u){return""}},showFavBody:function(){var e=kkTool.Cookie.get("userid");e?(kkTool.Dom.$("grzx_list_2_unlogin").style.display="none",kkTool.Dom.$("grzx_list_2_login").style.display="",kkTool.Dom.$("grzx_tab_2_numbox_more_login").href="http://t.kankan.com/"+e+"/fav?show=home",kkTool.Dom.$("grzx_tab_2_numbox_more_login").style.display="",kkTool.Dom.$("grzx_lnk").href="http://t.kankan.com/"):(this.count=0,kkTool.Dom.$("grzx_list_2_unlogin_text").innerHTML='请登录查看精彩收藏视频！<span class="c-login" onclick="Login.Show();return false;">登  录</span>',kkTool.Dom.$("grzx_list_2_unlogin").style.display="",kkTool.Dom.$("grzx_list_2_login").style.display="none",kkTool.Dom.$("grzx_tab_2_numbox").innerHTML="",kkTool.Dom.$("grzx_tab_2_numbox").style.display="none",kkTool.Dom.$("grzx_tab_2_numbox_more_login").style.display="none",kkTool.Dom.$("grzx_lnk").href="http://t.kankan.com/"+e)},formatFavData:function(e){var t={vodurl:"",version:e.version,movieId:e.movieid,title:e.movietitle,charge:e.charge,bigposter:e.bigposter,vbigposter:e.verbigposter,isNewUpdate:!1};return t.vodurl="http://vod.kankan.com/v/"+Math.floor(t.movieId/1e3)+"/"+t.movieId+".shtml",t.isNewUpdate=t.version&&t.version.indexOf("更新")>-1&&this.getFavRecord(t.movieId)!=t.version,t},printFav:function(){var t=this,i="",s="";if(KK_FAV_OBJ_GRZX.size>0){favData=KK_FAV_OBJ_GRZX.records;if(favData.length<=0)return!1;listLength=favData.length;var o="";for(var u=0;u<listLength;u++){var a=t.formatFavData(favData[u]);a.isNewUpdate&&t.count++,o+='<li id="fav_grzx_'+a.movieId+"_"+a.charge+'" data-update="'+a.isNewUpdate+'" data-charge="'+a.charge+'" movieid="'+a.movieId+'"><a title="'+a.title+'" href="'+a.vodurl+'" title="'+a.title+'" class="pic"><img src="http://img.movie.kankan.kanimg.com/img_default.gif" _src="http://img.movie.kankan.kanimg.com/150x210/'+a.vbigposter+'" width="150" height="210" alt="'+a.title+'"><span class="masktxt" style="display:none">'+a.title+'</span></a><p class="title'+(a.movietype!="movie"?"3":"4")+'"><a title="'+a.title+'" href="'+a.vodurl+'">'+a.title+'</a><span class="score"></span></p><p class="c-info2'+(a.isNewUpdate?" c1":"")+'">'+a.version+'</p><div class="cover" style="display:none;"><a href="'+a.vodurl+'" class="c-btn" title="'+a.title+'"><i></i></a><a class="c-close" title="删除" href="javascript:void(0)" target="_self"><i></i></a></div>'+(a.isNewUpdate?'<span class="c-tips">有更新</span>':"")+"</li>"}kkTool.Dom.$("grzx_fav_list").innerHTML=o,t.drawNumBox(),e("#grzx_fav_list li").hover(function(){e(this).find(".cover").show()},function(){e(this).find(".cover").hide()});try{e("#grzx_fav_list").css("margin-left","0px"),e("#grzx_fav_list_prev").addClass("scrolltigger_L_none")}catch(f){}r.init({current:0,allpage:t.getTurnPage(),step:t.getTurnStep(),prev:"grzx_fav_list_prev",next:"grzx_fav_list_next",div:"grzx_fav_list",clickflag:0,offClsLeft:"scrolltigger_L_none",offClsRight:"scrolltigger_R_none",auto:!1,speed:.3}),t.getTurnPage()<2?e("#grzx_fav_list_next").addClass("scrolltigger_R_none"):e("#grzx_fav_list_next").removeClass("scrolltigger_R_none"),n.init(),n.run(),this.bindDelFav(),this.pvRebind(),window.kkPageFav.delFavCbHandler=_.bind(t.delFav,t)}else kkTool.Dom.$("grzx_list_2_unlogin_text").innerHTML='<i class="c-collect"></i>暂无收藏内容',kkTool.Dom.$("grzx_list_2_unlogin").style.display="",kkTool.Dom.$("grzx_list_2_login").style.display="none"},drawNumBox:function(){var e=this;e.count>0?(kkTool.Dom.$("grzx_tab_2_numbox").innerHTML=(e.count<100?e.count:"99+")+'<span class="numbox_co"></span>',kkTool.Dom.$("grzx_tab_2_numbox").style.display=""):kkTool.Dom.$("grzx_tab_2_numbox").style.display="none"},getTurnStep:function(){return e(window).width()<1165?1020:1190},getTurnPage:function(){var t=e(window).width()<1165?6:7;return Math.ceil(e("#grzx_fav_list li").size()/t)},changeTurnStep:function(t){var n=this;n.getTurnPage()-1<=r.config.current?e("#grzx_fav_list_next").addClass("scrolltigger_R_none"):e("#grzx_fav_list_next").removeClass("scrolltigger_R_none"),r.config.allpage=n.getTurnPage(),r.config.step=n.getTurnStep()},pvRebind:function(){var e=this;typeof kk_click_pv_rebind=="function"?kk_click_pv_rebind():setTimeout(function(){e.pvRebind()},3e3)},bindDelFav:function(){var t=kkTool.Dom.$("grzx_fav_list").getElementsByTagName("li"),n=this;for(var r=0;r<listLength;r++){var i=t[r];(function(t){var r=t;e(t).find(".c-close").click(function(){return n.delFav(r),!1}),e(t).find("a").click(function(t){if(e(t.target).hasClass("c-close")||e(t.target).parents(".c-close").size()>0)return!1;n.ignoreFav(r)})})(i)}},ignoreFav:function(t){var n=this,r="",i="";!e(t).data("update")||(e(t).find(".c-tips").hide(),n.count--,n.drawNumBox())},delFav:function(t){var n=!1;if(arguments.length>1){var r=parseInt(arguments[1],10),i=parseInt(arguments[0],10);n=!0}else var r=parseInt(t.getAttribute("data-charge"),10),i=parseInt(t.getAttribute("movieid"),10);var s=this;kkTool.getScript(this.url+"delete?"+this.getBaseParams()+"&obj=delFavObj&movieid="+i+"&viewtype=long&charge="+r+"&rd="+Math.random(),function(){data=delFavObj;if(data&&data.code==0){var t=kkTool.Dom.$("fav_grzx_"+i+"_"+r);!e(t).data("update")||(s.count--,s.drawNumBox()),e("#fav_grzx_"+i+"_"+r).remove(),kkTool.Dom.$("grzx_fav_list").getElementsByTagName("li").length==0&&(kkTool.Dom.$("grzx_list_2_unlogin_text").innerHTML='<i class="c-collect"></i>暂无收藏内容',kkTool.Dom.$("grzx_list_2_unlogin").style.display="",kkTool.Dom.$("grzx_list_2_login").style.display="none"),n||window.kkPageFav.delFav(i,r),s.changeTurnStep()}else alert("删除失败请重试")},[],!0,"utf-8");var o="http://backend.t.kankan.com/user_fav.json",u="a=del&mid="+i+"&uid="+kkTool.Cookie.get("userid");CrossDomain.KKPOST(o,u,function(e){})}};return i}),define("viewHistory",["jquery","turn","lazy"],function(e,t,n){var r=new t;return viewHistory={historyNum:0,show_name:"",showMore:!1,vhCount:0,del:function(t,n){G_CORE_HISTORY.removeSingleInfo2(t,n);try{e("#history_update_"+t).is(":visible")&&this.vhCount--}catch(r){}e("#viewHistoryObj_"+t+"_"+n).remove(),this.drawNumBox(),this.changeTurnStep()},getCookie:function(e){try{return document.cookie.match(new RegExp("(^"+e+"| "+e+")=([^;]*)"))==null?"":decodeURIComponent(RegExp.$2)}catch(t){return""}},setEmpty:function(){this.showMore=!1,G_CORE_HISTORY.setEmpty(),this.buildViewHistory(),this.showEmptyView(!0)},showEmptyView:function(e){},init:function(){viewHistory.getCookie("sessionid")?G_CORE_HISTORY.getInfoOnline(function(){viewHistory.buildViewHistory()}):(G_CORE_HISTORY.dataOnline=[],viewHistory.buildViewHistory(),kkTool.Dom.$("grzx_tab_1_numbox").innerHTML="",kkTool.Dom.$("grzx_tab_1_numbox").style.display="none")},updateMovieInfo:function(){for(i=0;i<G_CORE_HISTORY._movieinfo.length;i++){var e=G_CORE_HISTORY._movieinfo[i].movieid+"_"+G_CORE_HISTORY._movieinfo[i].subid,t=document.getElementById("history_timming_"+e),n=document.getElementById("history_timming_per_"+e),r=document.getElementById("history_action_"+e),s=document.getElementById("history_title_"+e),o=document.getElementById("history_update_"+G_CORE_HISTORY._movieinfo[i].movieid),u=document.getElementById("history_img_"+e);if(!t)continue;s.innerHTML=o.innerHTML="";if(parseInt(G_CORE_HISTORY._movieinfo[i].stat)==0){s.innerHTML+="已下线",r.innerHTML="",s.style.display="";continue}if(G_CORE_HISTORY._movieinfo[i].update){this.vhCount++,s.innerHTML+="有更新";var a=G_CORE_HISTORY._movieinfo[i].update;G_CORE_HISTORY._movieinfo[i].type=="tv"||G_CORE_HISTORY._movieinfo[i].type=="documentary"||G_CORE_HISTORY._movieinfo[i].type=="lesson"?a.indexOf("更新")>=0?a=a.replace("更新",""):a.indexOf("-")>=0?(a=a.replace(/-/g,""),a=a.substr(4)):a="至"+a:a=a.replace("更新",""),o.innerHTML+=a,o.setAttribute("is_new",1),s.style.display=""}if(G_CORE_HISTORY._movieinfo[i].poster){var f="http://img.movie.kankan.kanimg.com/150x210/"+G_CORE_HISTORY._movieinfo[i].poster;u.setAttribute("src",f)}var l={movieid:G_CORE_HISTORY._movieinfo[i].movieid,subid:G_CORE_HISTORY._movieinfo[i].subid,nextid:G_CORE_HISTORY._movieinfo[i].nextsubid,timing:""};parseInt(G_CORE_HISTORY._movieinfo[i].movielength)<=parseInt(t.getAttribute("timming"))&&(r.innerHTML='<a class="c-btn" href="'+G_CORE_HISTORY._getPlayUrl(l,0)+'" target="_blank"><i></i>重播</a>');if(G_CORE_HISTORY._movieinfo[i].movielength){var c=Math.round(Math.round(parseInt(t.getAttribute("timming"))/parseInt(G_CORE_HISTORY._movieinfo[i].movielength)*1e4)/100);n.innerHTML="观看到"+(c>0?c:1)+"%"}G_CORE_HISTORY._movieinfo[i].nextsubid&&(r.innerHTML=r.innerHTML+'<a class="c-btn2" href="'+G_CORE_HISTORY._getPlayUrl(l,2)+'" target="_blank">下一集</a>')}this.drawNumBox()},drawNumBox:function(){this.vhCount>0?(kkTool.Dom.$("grzx_tab_1_numbox").innerHTML=(this.vhCount<100?this.vhCount:"99+")+'<span class="numbox_co"></span>',kkTool.Dom.$("grzx_tab_1_numbox").style.display=""):(kkTool.Dom.$("grzx_tab_1_numbox").innerHTML="",kkTool.Dom.$("grzx_tab_1_numbox").style.display="none")},buildViewHistoryCell:function(e){var t="",n=G_CORE_HISTORY.getOutputItem(e);return n.url_continue.length<1&&(n.url_continue=n.url_this),n.timing.length<1&&(n.timing="观看到1%"),t='<li id="viewHistoryObj_'+parseInt(e.movieid)+"_"+parseInt(e.movie_id)+'">',t+='<a href="'+n.url_this+'" title="'+n.movie_name+'" class="pic" title="'+n.movie_title+'">',t+='<img id="history_img_'+e.movieid+"_"+e.subid+'" src="'+(n.poster?"http://img.movie.kankan.kanimg.com/150x210/"+n.poster:"http://misc.web.xunlei.com/www/v8/img/img_bg/default_150x210.jpg")+'" width="150" height="210" alt="'+n.movie_name+'">',t+="</a>",t+='<p class="title">',t+='<a title="'+n.movie_title+'" href="'+n.url_this+'">'+n.movie_title+"</a>",t+='<span class="score" id="history_update_'+e.movieid+'"></span>',t+="</p>",t+='<p class="c-info" id="history_timming_'+e.movieid+"_"+e.subid+'" timming="'+e.timing+'">'+n.device_name_html+(e.movietype!="teleplay"?"":n.subname+" ")+'<span id="history_timming_per_'+e.movieid+"_"+e.subid+'">'+n.timing+"</span><i></i></p>",t+='<div class="cover" style="display:none;" >',t+='<div id="history_action_'+e.movieid+"_"+e.subid+'"><a title="'+n.movie_title+'" href="'+n.url_continue+'" class="c-btn"><i></i>继续播放</a></div>',t+='<a href="javascript:void(0)" target="_self" class="c-close" title="删除" onclick="viewHistory.del('+parseInt(e.movieid)+","+parseInt(e.movie_id)+');"><i></i></a>',t+="</div>",t+='<span class="c-tips" id="history_title_'+e.movieid+"_"+e.subid+'" style="display:none"></span>',t+="</li>",t},buildViewHistory:function(){var t=G_CORE_HISTORY.getInfo();this.vhCount=0,t=t.slice(0,28);var n="",s="",o=this;if(t.length>0)for(i=0;i<t.length;i++)s+=viewHistory.buildViewHistoryCell(t[i]),n+=(n?",":"")+t[i].movieid+"|"+t[i].subid;kkTool.Dom.$("grzx_tab_1_numbox_more_login").style.display="none",kkTool.Dom.$("grzx_tab_1_numbox_more_unlogin").style.display="none";if(s){document.getElementById("grzx_view_history").innerHTML=s,n&&G_CORE_HISTORY.getmovieinfo(n,function(){viewHistory.updateMovieInfo()}),e("#grzx_view_history li").hover(function(){e(this).find(".cover").show()},function(){e(this).find(".cover").hide()});try{e("#grzx_view_history").css("margin-left","0px"),e("#grzx_view_history_prev").addClass("scrolltigger_L_none")}catch(u){}r.init({current:0,allpage:o.getTurnPage(),step:o.getTurnStep(),prev:"grzx_view_history_prev",next:"grzx_view_history_next",div:"grzx_view_history",clickflag:0,offClsLeft:"scrolltigger_L_none",offClsRight:"scrolltigger_R_none",auto:!1,speed:.3}),o.getTurnPage()<2?e("#grzx_view_history_next").addClass("scrolltigger_R_none"):e("#grzx_view_history_next").removeClass("scrolltigger_R_none"),document.getElementById("grzx_list_1_unlogin").style.display="none",document.getElementById("grzx_list_1_login").style.display="";try{o.pvRebind()}catch(a){}viewHistory.getCookie("sessionid")?(kkTool.Dom.$("grzx_tab_1_numbox_more_login").href="http://t.kankan.com/"+viewHistory.getCookie("userid")+"/history?show=home",kkTool.Dom.$("grzx_tab_1_numbox_more_login").style.display="",kkTool.Dom.$("grzx_tab_1_numbox_more_unlogin").style.display="none"):(kkTool.Dom.$("grzx_tab_1_numbox_more_login").style.display="none",kkTool.Dom.$("grzx_tab_1_numbox_more_unlogin").style.display="")}else viewHistory.getCookie("sessionid")?document.getElementById("grzx_list_1_unlogin_text").innerHTML='<i class="c-record"></i>暂无观看记录':document.getElementById("grzx_list_1_unlogin_text").innerHTML='请登录后，查看云观看记录<span class="c-login" onclick="Login.Show();return false;">登  录</span>',document.getElementById("grzx_list_1_unlogin").style.display="",document.getElementById("grzx_list_1_login").style.display="none"},pvRebind:function(){var e=this;typeof kk_click_pv_rebind=="function"?kk_click_pv_rebind():setTimeout(function(){e.pvRebind()},3e3)},getTurnStep:function(){return e(window).width()<1165?1020:1190},getTurnPage:function(){var t=e(window).width()<1165?6:7;return Math.ceil(e("#grzx_view_history li").size()/t)},changeTurnStep:function(t){var n=this;r.config.step=n.getTurnStep(),r.config.allpage=n.getTurnPage(),n.getTurnPage()-1<=r.config.current?e("#grzx_view_history_next").addClass("scrolltigger_R_none"):e("#grzx_view_history_next").removeClass("scrolltigger_R_none")},display:!1},viewHistory}),require.config({baseUrl:"http://misc.web.xunlei.com/www/v8/js",urlArgs:"date=20131227"}),typeof window.kkHeader=="undefined"&&(window.kkHeader={});var MovieUpdate0={current:0,allpage:2,step:715,a:"a_movieupdate0_",div:"RelatedRecommendContainer",bt:"bt_movieupdate0_",clickflag:0,perpicnum:5,img:[]},SUBMOVIEID=[];require(["domReady","switchtab","eventutil","dom","lazy","turn","jquery","fav","viewHistory"],function(e,t,n,r,i,s,o,u,a){var f={vh:!1};kkHeader.gAutoLoginSuccess=function(){e(function(){!kkTool.Cookie.get("sessionid")||(o("#grzx_list_2_unlogin").show(),o("#grzx_list_2_login").hide(),o("#grzx_list_2_unlogin_text").html("加载中……")),u.prepareFav(),kkHeader.userInfo.uid?G_CORE_HISTORY.getInfoOnline(function(){RelatedRecommenderV8.init()}):RelatedRecommenderV8.init()})},kkHeader.gLogoutSuccess=function(){f={vh:!1},u.prepareFav(),a.init()},kkHeader.gLoginSuccess=function(){o("#grzx_tab_1").hasClass("cur")?(a.init(),f.vh=!0):f={vh:!1},u.prepareFav()};var l=new t,c=new t,h=new t,p=new t,d=new t,v=new t,m=new t,g=new t,y=new t,b=new t,w=new t,E=new t,S=new t,x=new t,T=new t,N=new t;t1=new s,t2=new s,t3=new s,e(function(){function e(t){t>10&&(t=1),setTimeout(function(){document.getElementById("figure_"+t+"_0").style.display=="none"?(document.getElementById("figure_"+t+"_1").style.display="none",o("#figure_"+t+"_0").fadeIn(1e3)):(document.getElementById("figure_"+t+"_0").style.display="none",o("#figure_"+t+"_1").fadeIn(1e3)),e(t+1)},6e3)}function t(){return o(window).width()<1165?1020:1190}i.init(),i.run(),N.init({identifyTab:"grzx_tab_",identifyList:"grzx_list_",count:3,cnon:"cur",lag:300,callback:{0:function(){o("#grzx_tab_1_numbox_more").hide(),o("#grzx_tab_2_numbox_more").hide()},1:function(){o("#grzx_tab_2_numbox_more").hide(),o("#grzx_tab_1_numbox_more").show(),f.vh===!1&&(a.init(),f.vh=!0)},2:function(){o("#grzx_tab_1_numbox_more").hide(),o("#grzx_tab_2_numbox_more").show()}}}),o("a.scrolltigger").click(function(){setTimeout(function(){i.resize_run()},400)}),e(1),t1.init({current:0,allpage:3,step:t(),prev:"scrolltigger_L",next:"scrolltigger_R",div:"RelatedRecommendContainer",clickflag:0,offClsLeft:"scrolltigger_L_none",offClsRight:"scrolltigger_R_none",auto:!1,speed:.3}),RelatedRecommenderV8.setNewMovieTurn(t1),c.init({identifyTab:"tabbox2_tab_",identifyList:"tabbox2_list_",count:2,cnon:"cur",lag:300}),h.init({identifyTab:"tabbox_spkb_tab_",identifyList:"tabbox_spkb_list_",count:4,cnon:"cur",lag:300}),d.init({identifyTab:"tabbox_dsj_tab_",identifyList:"tabbox_dsj_list_",count:4,cnon:"cur",lag:300}),v.init({identifyTab:"tabbox_dy_tab_",identifyList:"tabbox_dy_list_",count:5,cnon:"cur",lag:300}),m.init({identifyTab:"tabbox_qqyg_tab_",identifyList:"tabbox_qqyg_list_",count:3,cnon:"cur",lag:300}),g.init({identifyTab:"tabbox_dyy_tab_",identifyList:"tabbox_dyy_list_",count:3,cnon:"cur",lag:300}),y.init({identifyTab:"tabbox_zy_tab_",identifyList:"tabbox_zy_list_",count:4,cnon:"cur",lag:300}),b.init({identifyTab:"tabbox_zymrgx_tab_",identifyList:"tabbox_zymrgx_list_",count:7,cnon:"cur",lag:300}),w.init({identifyTab:"tabbox_dm_tab_",identifyList:"tabbox_dm_list_",count:4,cnon:"cur",lag:300}),E.init({identifyTab:"tabbox_yy_tab_",identifyList:"tabbox_yy_list_",count:4,cnon:"cur",lag:300}),S.init({identifyTab:"tabbox_jlp_tab_",identifyList:"tabbox_jlp_list_",count:4,cnon:"cur",lag:300}),x.init({identifyTab:"tabbox_gkk_tab_",identifyList:"tabbox_gkk_list_",count:4,cnon:"cur",lag:300}),T.init({identifyTab:"tabbox_yx_tab_",identifyList:"tabbox_yx_list_",count:4,cnon:"cur",lag:300}),b.show((new Date).getDay());var s=function(){var e=document.documentElement?document.documentElement.clientWidth:document.body.clientWidth;e<1165?t1.config.step=t():t1.config.step=t(),u.changeTurnStep(),a.changeTurnStep()};o(window).on("resize",function(){s()}),o("#floatpannel_app").mouseover(function(){o("#floatpannel_app").addClass("floatpannel_app_on")}).mouseout(function(){o("#floatpannel_app").removeClass("floatpannel_app_on")});var l=o("#back-top"),p=o("#searcharea-main").children().detach(),C=function(){var e=o(document).scrollTop(),t=o(window).height();e>500?(l.show(),o("#searcharea-mini").append(p),o("#mid-header-outer").fadeIn()):(l.hide(),o("#searcharea-main").append(p),o("#mid-header-outer").hide()),window.XMLHttpRequest||l.css("top",e+t-166)};o("#back-top").click(function(){o("html, body").animate({scrollTop:0},120)});var k=null;o(window).bind("scroll",function(){k&&clearTimeout(k),k=setTimeout(C,300)}),C(),n.addEventHandler(r("focus_tigger_5").getEle(),"click",function(){sendkkpv(configs_1923.packageUrl)}),n.addEventHandler(r("focus_tigger_6").getEle(),"click",function(){sendkkpv(configs_1924.packageUrl)}),n.addEventHandler(r("focus_tigger_7").getEle(),"click",function(){sendkkpv(configs_1925.packageUrl)}),n.addEventHandler(r("focus_title_5").getEle(),"click",function(){sendkkpv(configs_1923.packageUrl)}),n.addEventHandler(r("focus_title_6").getEle(),"click",function(){sendkkpv(configs_1924.packageUrl)}),n.addEventHandler(r("focus_title_7").getEle(),"click",function(){sendkkpv(configs_1925.packageUrl)})})}),define("index_v8_init",function(){});